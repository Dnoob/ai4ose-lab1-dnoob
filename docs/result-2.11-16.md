# AI4OSE 里程碑总结

**日期**：2026年2月16日

**周期**：2026.02.11 — 2026.02.16（第一周）

作者：Dnoob



## 一、个人进展

### 1.1 完成情况

| 实验 | 内容                                              | 状态     |
| ---- | ------------------------------------------------- | -------- |
| ch1  | 裸机程序（Hello World）                           | ✅ 已完成 |
| ch2  | 批处理系统（特权级 + Trap + 系统调用）            | ✅ 已完成 |
| ch3  | 多道程序与分时共享（任务切换 + 时钟中断 + yield） | ✅ 已完成 |
| ch4  | 地址空间与虚拟内存（SV39页表 + mmap/munmap）      | ✅ 已完成 |
| ch5  | 进程管理（fork/exec/waitpid）                     | ❌ 未完成 |

### 1.2 学习收获

**操作系统核心概念：**

从 ch1 到 ch3，我实际走过了操作系统内核演进的前三个阶段 —— 裸机 → 批处理 → 多道程序/分时共享。最大的收获是理解了每一步演进都在解决上一步的具体痛点：裸机没有任务保护机制，批处理引入特权级解决了安全隔离但一次只能跑一个程序，多道程序通过任务切换实现了并发但需要时钟中断来保证公平调度。

通过 ch4 的学习，初步理解了 RISC-V SV39 三级页表结构、虚拟地址到物理地址的翻译过程、以及 satp 寄存器在地址空间切换中的作用。

 **Rust语言：**

从零开始学Rust，在项目中逐步掌握了：`#![no_std]`裸机编程模式、`Ret::Done(ret)`模式匹配与解构、`impl Trait for Type` trait 系统、`unsafe`块的使用场景、`mut` 可变性语义。每次遇到不熟悉的语法都是在实际代码上下文中学的，比纯看教程效率高。

**教学设计能力：**

这是意料之外的收获。写教材比写代码难得多 —— 填空位置怎么选、 hint 给多少、概念铺垫的顺序，都需要反复斟酌。总结出了一套方法论（见下文 1.4）。

### 1.3 遇到的困难

**概念理解**：

- 最初不理解项目定位 —— 以为是纯学习，不明白为什么要“搭建教学环境”。后来理解了"边学边教"的理念：把学到的东西用自己的话写出来，本身就是最高效的学习方式。
- ch4 虚拟内存是目前概念密度最高的一章。SV39 三级页表、VPN/PPN 拆分、页表项标志位、Portal/Trampoline 机制，这些都需要反复看文档和代码才能串起来。

**教材设计：**

- **类比选择的反复：**特权级的类比经历了多次迭代 —— 最初用 C++ 类比（如所有权≈智能指针），后来意识到目标是零基础学生，改用银行比喻（顾客=U-mode、柜员=S-mode、金库管理员=M-mode）。找到一个既准确又不依赖技术背景的类比比想象中困难得多。
- **概念铺垫的度：**讲多了学习者没耐心读，讲少了后面代码看不懂。比如Lab2的TrapContext结构体 —— 要不要在 README 里展开讲每个寄存器字段的作用？最终决定只讲关键的几个（sepc、scause、sstatus），其余留到代码走读环节。

**学习与产出的平衡：**

- **时间冲突：**自己还没完全吃透概念就要开始写教材，经常是边写边改。有时候写到一半发现自己理解有误，得推翻重来。理想状态是"先彻底学会再写"，但时间上不允许，两者必须并行。
- **Rust + OS 双重学习曲线：** 同时学两样东西，遇到报错经常分不清是Rust问题还是OS问题。比如 Lab3 遇到栈溢出，一开始以为是 Rust 的数组初始化写法有问题，排查了半天才发现是内核栈空间不够。两个未知叠加在一起显著增加了调试难度。

### 1.4 沉淀的方法论

**三层概念解释法**：定义 → 生活类比 → 代码示例。面向零基础学生，类比要避免技术性（不用C++ 对比）。例如用"银行"比喻特权级：顾客（U-mode）、柜员（S-mode）、金库管理员（M-mode）。

**填空式渐进教学：**每个 lab 的 TODO 按复杂度递增排列，每填完一个就能 `cargo run` 看到阶段性结果，保持学生的成就感。 lab2的四个TODO 从简单的 sys_write → sys_exit → trap 分发 → syscall调度，形成自然的学习坡度。

**六段式 README 结构：** 概述与目标 → 背景知识 → 核心概念讲解 → 动手实验（TODO步骤）→ 代码走读 → 习题与扩展。每个 Lab 保持一致结构。



## 二、项目层面

### 2.1 项目本身的不足

**缺少自动化测试：** 当前所有测试都手动 `cargo run` 看输出。理想状态应该有自动化测试脚本，能验证学生填完 TODO 后的代码是否正确。

**缺少教学视频：**目前全部教材都是文字形式（README + 代码注释），缺少配套的教学视频。对于一些动态过程（如Trap上下文切换的寄存器变化、三级页表的逐级查找），视频或动画演示比纯文字描述更直观。但限于时间精力和视频制作能力，短期内难以产出高质量的教学视频。

### 2.2 对项目/课程的建议

**关于参考代码（rCore-Tutorial-in-single-workspace）：**

组件化代码库的注释偏重描述"是什么"，较少解释"为什么"。比如 execute_naked() 汇编函数和页表操作的关键代码，注释说明了每一行做了什么操作，但很少解释为什么要这么做、不这么做会产生什么后果。对初学者来说，"为什么"往往比"是什么"更关键——理解了动机才能举一反三，否则只是记住了步骤
